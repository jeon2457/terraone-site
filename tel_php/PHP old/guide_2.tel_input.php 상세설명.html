<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>tel_input.php 흐름 정리</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f6f9; }
.container { max-width: 900px; margin: 30px auto; padding: 20px; background: #fff; border-radius: 10px; box-shadow: 0 3px 10px rgba(0,0,0,0.1); }
h1 { text-align:center; color:#007bff; margin-bottom: 30px; }
.step { margin-bottom: 25px; }
.step h4 { color: #0056b3; }
.flowchart { background: #e9f3ff; padding: 20px; border-radius: 10px; border: 1px solid #c9e3ff; margin-bottom: 30px; }
.flowchart pre { background: #f0f8ff; padding: 15px; border-radius: 5px; font-size: 0.95rem; }
.badge-info { font-size: 0.85rem; }
</style>
</head>
<body>
<div class="container">
<h1>tel_input.php 기능 & 흐름 정리</h1>

<div class="step">
  <h4>1️⃣ 관리자 인증 및 DB 연결</h4>
  <p>
    <strong>auth_check.php</strong>로 로그인 + 관리자 확인 후, <strong>db-connect-pdo.php</strong>를 통해 DB 연결 수행.
    <br>SMS_2 자동 업데이트 함수는 <strong>update_leaders_sms2.php</strong>에 정의되어 있음.
  </p>
</div>

<div class="step">
  <h4>2️⃣ 회원 입력 처리 (POST)</h4>
  <ul>
    <li>사용자 입력값 수집 (id, password, name, tel, addr, remark, sms, sms_2, user_level)</li>
    <li>비밀번호 해싱 (password_hash)</li>
    <li><strong>회장/총무 자동 SMS_2 생성</strong>  
      - 현재 등록 중인 전화번호 제외  
      - 남은 번호들을 콤마로 연결하여 SMS_2 생성
    </li>
    <li>DB에 신규 회원 삽입</li>
    <li>기존 회장/총무 SMS_2 자동 갱신</li>
    <li>updateLeadersSms2($pdo) 호출: 전체 회장/총무 SMS_2 최신화</li>
    <li>저장 완료 후 알림 및 목록페이지 이동</li>
  </ul>
</div>

<div class="step">
  <h4>3️⃣ 실시간 SMS_2 생성 안내 (프론트엔드)</h4>
  <p>
    비고 입력란에서 "회장" 또는 "총무" 입력 시, 폼에서 SMS_2 필드가 읽기전용으로 바뀌고 안내 텍스트 표시.
    <br>DB 저장 시 자동으로 생성된 SMS_2가 삽입됨.
  </p>
</div>

<div class="step">
  <h4>4️⃣ 핵심 흐름도</h4>
  <div class="flowchart">
<pre>
[관리자 인증]
       │
       ▼
   [DB 연결]
       │
       ▼
[회원 입력 폼 제출?] --No--> [폼 화면 표시]
       │Yes
       ▼
[입력값 수집 + 비밀번호 해싱]
       │
       ▼
[비고 확인: 회장/총무?] --Yes--> [자동 SMS_2 생성]
       │
       ▼
[신규 회원 DB 삽입]
       │
       ▼
[기존 회장/총무 SMS_2 자동 업데이트]
       │
       ▼
[updateLeadersSms2($pdo) 호출]
       │
       ▼
[저장 완료 알림 & 목록페이지 이동]
</pre>
  </div>
  <p>이 흐름으로 인해, 실시간 생성 + DB 자동 업데이트가 동시에 작동하며, tel_view.php에서 최신 정보 확인 가능.</p>
</div>

<div class="step">
  <h4>5️⃣ 핵심 포인트</h4>
  <ul>
    <li>디자인은 완전히 유지됨</li>
    <li>회장/총무는 SMS_2 자동 생성</li>
    <li>기존 회장/총무 SMS_2도 항상 최신 상태 유지</li>
    <li>실시간 생성 안내는 사용자에게 직관적으로 보여짐</li>
  </ul>
</div>




</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
