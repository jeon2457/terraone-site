â˜…â˜…â˜…â˜…â˜… [[ í•„ ë…: ì‚¬ìš©ë²• ]] â˜…â˜…â˜…â˜…â˜…

ì´ê³³ì— ìˆëŠ” ì½”ë“œíŒŒì¼ì€ jikji35ì „í™”ì—°ë½ë§ì„ ì™„ì „ ìƒˆë¡œìš´ ë°©ì‹ìœ¼ë¡œ í˜ì´ì§€ë¥¼ ë§Œë“¤ê¸°ìœ„í•´ ì‚¬ìš©ë˜ì—ˆë‹¤.
êµ¬ê¸€ firebase(https://console.firebase.google.com/ : êµ¬ê¸€ê³„ì •(jeon2457@gmail.com)ì—ì„œ Realtime Database ë°ì´íƒ€ë² ì´ìŠ¤ì™€ ì—°ê²°ì‹œí‚¤ê³  ê¹ƒí—ˆë¸Œ(https://github.com/ ê³„ì •: jeon2457@gmail.com - jeon2457(terraone-site)) ë¡œ ì„œë¡œ ì—°ê²°ë˜ì–´ìˆë‹¤. 

(ì‘ì—…-1)
íŒŒì¼ì€ ë‚´ì»´ íƒìƒ‰ê¸° C:\GitHub\terraone-siteì— ë“¤ì–´ìˆëŠ”ë° í¸ì§‘í•˜ê³  êµ¬ê¸€ì„œë²„ë¡œ ì—…ë°ì´íŠ¸ í•˜ë ¤ë©´  ë¹„ì£¼ì–¼ìŠ¤íŠœë””ì˜¤ì½”ë“œë¡œ
ì‘ì—…ì„ í•˜ê³  GitHub Desktopí”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•˜ë©´ ë³€ê²½ëœê²ƒì€ ì—¬ê¸°ì„œ ê°ì§€í•œë‹¤.  commitì²˜ë¦¬í•˜ê³  Push Originí•´ì£¼ë©´ 
ìë™ìœ¼ë¡œ ê¹ƒí—ˆë¸Œë¡œ ë°ì´íƒ€ ì—…ë°ì´íŠ¸ë˜ê³  êµ¬ê¸€firebase ì„œë²„ìª½ê³¼ ì›¹í˜¸ìŠ¤íŒ… ì²˜ë¦¬ê°€ëœë‹¤.

(ì‘ì—…-2)
ë„ìŠ¤ í”„ë¡¬í”„íŠ¸ ëª…ë ¹ì–´: 
ë‚´ì»´í“¨í„° C:\GitHub\terraone-site ì— ì›ë³¸ íŒŒì¼ì´ ë“¤ì–´ìˆê³ , ë°ì´íƒ€ ì½”ë“œë¥¼ ìˆ˜ì •í• ë•ŒëŠ”, ë°˜ë“œì‹œ ë„ìŠ¤ì—ì„œ ê²½ë¡œë¥¼
c:\user> cd C:\GitHub\terraone-site í´ë”ë¡œ ì´ë™í•œ í›„ì— 
C:\GitHub\terraone-site>   firebase login   ë¡œ ë¡œê·¸ì¸ì´ ëœê²ƒì„ í™•ì¸ì„í•˜ê³ ,
C:\GitHub\terraone-site>   firebase deploy --only hosting   ìœ¼ë¡œ êµ¬ê¸€ì„œë²„ë¡œ ì—…ë°ì´íŠ¸ì„ íƒ)
C:\GitHub\terraone-site>  firebase deploy  ë¡œ ì‹¤í–‰í•˜ë©´ ì „ì²´ì½”ë“œë¥¼ ì—…ë°ì´íŠ¸í•œë‹¤.(ì„ íƒ)

=============================================================================

ì½”ë“œìˆ˜ì •ì—†ì´ ë°ì´íƒ€ë² ì´ìŠ¤(DB) ë°ì´íƒ€ë¥¼ ì…ë ¥/ìˆ˜ì •/ì‚­ì œ í• ê²½ìš°ëŠ” í•´ë‹¹ htmlíŒŒì¼ì„ ì‹¤í–‰í•˜ë©´ëœë‹¤.

ğŸ“‹ êµ¬ê¸€ firebase / Realtime Database ì „ì²´ í˜ì´ì§€ ëª©ë¡	
	
í˜ì´ì§€	URL
íšŒì›ì—°ë½ë§ ë©”ì¸	https://terraone-d0318.web.app/
ê´€ë¦¬ì ë¡œê·¸ì¸	https://terraone-d0318.web.app/login.html
ê´€ë¦¬ì íšŒì›ê°€ì…	https://terraone-d0318.web.app/signup.html
ê´€ë¦¬ì íšŒì›ëª©ë¡	https://terraone-d0318.web.app/members.html
ê´€ë¦¬ì íšŒì›í¸ì§‘	https://terraone-d0318.web.app/edit-member.html
	
ê´€ë¦¬ì ì‚¬ìš©ë‚´ì—­ì„œ ì…ë ¥	https://terraone-d0318.web.app/account_input.html
ê´€ë¦¬ì ì‚¬ìš©ë‚´ì—­ì„œ í¸ì§‘	https://terraone-d0318.web.app/account_edit.html
ì‚¬ìš©ë‚´ì—­ì„œ ë³´ê¸°	https://terraone-d0318.web.app/account_view.html
	
	
ê´€ë¦¬ì ì˜ìˆ˜ì¦ ì…ë ¥	https://terraone-d0318.web.app/images_input.html
ê´€ë¦¬ì ì˜ìˆ˜ì¦ í¸ì§‘	https://terraone-d0318.web.app/images_edit.html
ì˜ìˆ˜ì¦ ë³´ê¸°	https://terraone-d0318.web.app/images_view.html
	


=============================================================================


<!--  â˜†â˜…â˜†  terraone-site í´ë”êµ¬ì¡°  â˜†â˜…â˜†


C:\GitHub\terraone-site
â”‚
â”œâ”€ .firebase/
â”œâ”€ .git/
â”œâ”€ .github/
â”œâ”€  css/
â”œâ”€ image/
â”‚
â”œâ”€ public/
â”‚   â”œâ”€ css/
â”‚   â”œâ”€ css_firebase/
â”‚   â”œâ”€ favicons/
â”‚   â”‚    
â”‚   â”œâ”€ image/
â”‚   â”‚    â””â”€ sms-4.png
â”‚   â”œâ”€ images/
â”‚   â”‚
â”‚   â”‚ 
â”‚   â”œâ”€ js/
â”‚   â”‚    â”œâ”€ auth.js
â”‚   â”‚    â”œâ”€ edit-member.js
â”‚   â”‚    â”œâ”€ firebase-config.js
â”‚   â”‚    â”œâ”€ firebase-db.js
â”‚   â”‚    â”œâ”€ index-firebase.js
â”‚   â”‚    â”œâ”€ login.js
â”‚   â”‚    â”œâ”€ members.js 
â”‚   â”‚    â””â”€ signup.js
â”‚   â”‚
â”‚   â”œâ”€ edit-member.html  
â”‚   â”œâ”€ favicon.ico
â”‚   â”œâ”€ firebase.json
â”‚   â”œâ”€ index.html
â”‚   â”œâ”€ login.html
â”‚   â”œâ”€ manifest.json
â”‚   â”œâ”€ members.html
â”‚   â”œâ”€ account_edit.html
â”‚   â”œâ”€ account_input.html
â”‚   â”œâ”€ account_view.html
â”‚   â”œâ”€ images_edit.html
â”‚   â”œâ”€ images_upload.html
â”‚   â”œâ”€ images_view.html
â”‚   â””â”€ signup.html
â”‚
â”œâ”€ .firebaserc
â”œâ”€ .gitattributes
â”œâ”€ .gitgnore
â”œâ”€ cors.json
â”œâ”€ database.rules.json
â”œâ”€ favicon.ico
â”œâ”€ manifest.json
â”œâ”€ package.json
â”‚
â””â”€ (ê¸°íƒ€ íŒŒì¼ë“¤)


 -->





=============================================================================

ğŸš€ GitHubì—ì„œ í•´ì•¼ í•  ì‘ì—…(ê¹ƒí—ˆë¸Œì™€ ì—°ë™ì´ ì•ˆë ê²½ìš° í•´ì•¼í• ê²ƒ!) ==>  ì‚¬ìš© ë³´ë¥˜ !!
Firebase í† í° ë°œê¸‰

ë¡œì»¬ì—ì„œ firebase login:ci ì‹¤í–‰ â†’ í† í° ë°œê¸‰

1. Firebase í† í° ë“±ë¡
ë°©ê¸ˆ firebase login:ci ì‹¤í–‰ í›„ í„°ë¯¸ë„ì— ê¸´ ë¬¸ìì—´ í† í°ì´ ì¶œë ¥ë˜ì—ˆì„ ê²ë‹ˆë‹¤.

ì´ í† í°ì„ ë³µì‚¬í•´ë‘ì„¸ìš”.

ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œ(terraone-site)ì—ì„œ:

Settings â†’ Secrets and variables â†’ Actions â†’ New repository secretìœ¼ë¡œ ì´ë™

ì´ë¦„ì€ FIREBASE_TOKENìœ¼ë¡œ ì§€ì •

ê°’ì— ë°©ê¸ˆ ë³µì‚¬í•œ í† í° ë¶™ì—¬ë„£ê¸° â†’ ì €ì¥


2. GitHub Actions ì›Œí¬í”Œë¡œìš° íŒŒì¼ ìƒì„±
ì €ì¥ì†Œ ë£¨íŠ¸ì— .github/workflows/firebase-hosting.yml íŒŒì¼ì„ ìƒˆë¡œ ë§Œë“­ë‹ˆë‹¤.

ì˜ˆì‹œ ì„¤ì •:
name: Deploy to Firebase Hosting

on:
  push:
    branches:
      - main   # main ë¸Œëœì¹˜ì— pushë  ë•Œ ì‹¤í–‰

jobs:
  build_and_deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'

      - name: Install dependencies
        run: npm install

      - name: Build project
        run: npm run build

      - name: Deploy to Firebase Hosting
        uses: FirebaseExtended/action-hosting-deploy@v0
        with:
          repoToken: "${{ secrets.GITHUB_TOKEN }}"
          firebaseServiceAccount: "${{ secrets.FIREBASE_TOKEN }}"
          channelId: live
          projectId: terraone-d0318   # Firebase í”„ë¡œì íŠ¸ IDë¡œ êµì²´


3. Actions ì‹¤í–‰ í™•ì¸
ì €ì¥ì†Œì—ì„œ Actions íƒ­ìœ¼ë¡œ ë“¤ì–´ê°€ë©´, ë°©ê¸ˆ ë§Œë“  ì›Œí¬í”Œë¡œìš°ê°€ ë³´ì…ë‹ˆë‹¤.

main ë¸Œëœì¹˜ì— pushí•˜ë©´ ìë™ìœ¼ë¡œ Firebase Hostingì— ë°°í¬ë©ë‹ˆë‹¤.

ì„±ê³µí•˜ë©´ Firebase Hostingì—ì„œ ì‚¬ì´íŠ¸ê°€ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.

âœ… ìš”ì•½

Firebase í† í°ì„ GitHub Secretsì— ë“±ë¡

.github/workflowsì— ë°°í¬ìš© YAML ì‘ì„±

Actions íƒ­ì—ì„œ ì‹¤í–‰ í™•ì¸


=============================================================================
=============================================================================


ë©”ì¸: https://terraone-d0318.web.app/
ë¡œê·¸ì¸https://terraone-d0318.web.app/login.html
íšŒì›ê°€ì…https://terraone-d0318.web.app/signup.html
íšŒì›ëª©ë¡https://terraone-d0318.web.app/members.html
íšŒì›ìˆ˜ì •https://terraone-d0318.web.app/edit-member.html


=====================================================================
=====================================================================

1.  html í˜ì´ì§€ì— ìŠ¤í¬ë¦½íŠ¸ ì‚½ì…!
    ex)  public/index.htmlì— ì•„ë˜ì²˜ëŸ¼ ì¶”ê°€:

	<script type="module" src="js/firebase-db.js"></script>

2. jsí´ë”ë‚´ì— ë°ì´íƒ€ë² ì´ìŠ¤ì™€ ì—°ê²°ë˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€!
	- firebase-db.js
	- firebase-config.js



=====================================================================
=====================================================================

1. public/js/firebase-db.js ìˆ˜ì • â†’ ë¡œì»¬ì—ì„œ Emulatorë¡œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥:

firebase emulators:start


Hosting: http://127.0.0.1:5000

Database: http://127.0.0.1:4000/database


2. ë¬¸ì œê°€ ì—†ìœ¼ë©´ Firebase Hostingì— ë°°í¬:

firebase deploy --only hosting (ë„ìŠ¤í”„ë¡¬í”„íŠ¸ì—ì„œ ì‹¤í–‰)


===================================================================
===================================================================


í”„ë¡œì íŠ¸ ì´ë¦„
terraone
í”„ë¡œì íŠ¸ ID
terraone-d0318
í”„ë¡œì íŠ¸ ë²ˆí˜¸
1082807340877
ì•± ë‹‰ë„¤ì„
terraone
ì•± ID
1:1082807340877:web:6e2b49c04562d800e87104
ì—°ê²°ëœ Firebase í˜¸ìŠ¤íŒ… ì‚¬ì´íŠ¸
terraone-d0318

=====================================================================
npm install firebase
ê·¸ëŸ° ë‹¤ìŒ Firebaseë¥¼ ì´ˆê¸°í™”í•˜ì—¬ ì‚¬ìš©í•˜ë ¤ëŠ” ì œí’ˆì˜ SDKë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.




=====================================================================

[[ js ì½”ë“œ ì†ŒìŠ¤ëª¨ìŒ ]]

// ğŸ“ public/js/firebase-db.js
// ğŸ”¹ firebase-db.js (ì™„ì „ ë²„ì „)
import { app } from "./firebase-config.js";
import { getDatabase, ref, set, push, get, child, update, remove } 
  from "https://www.gstatic.com/firebasejs/10.6.0/firebase-database.js";

const db = getDatabase(app);
const membersRef = ref(db, "terraone/tel");

// âœ… íšŒì› ë“±ë¡ í•¨ìˆ˜
export function addMember(member) {
  return push(membersRef, member)
    .then(() => console.log("âœ… ìƒˆ íšŒì› ë“±ë¡ ì™„ë£Œ"))
    .catch(err => console.error("âŒ ë“±ë¡ ì‹¤íŒ¨:", err));
}

// âœ… ì „ì²´ íšŒì› ê°€ì ¸ì˜¤ê¸°
export async function getAllMembers() {
  const snapshot = await get(membersRef);
  if (snapshot.exists()) {
    return snapshot.val();
  } else {
    return {};
  }
}

// âœ… ë¡œê·¸ì¸ í•¨ìˆ˜ (ëˆ„ë½ë˜ì–´ ìˆë˜ ë¶€ë¶„!)
export async function login(id, password) {
  const snapshot = await get(membersRef);
  if (!snapshot.exists()) {
    return null;
  }

  const members = snapshot.val();
  
  // ëª¨ë“  íšŒì›ì„ ìˆœíšŒí•˜ë©´ì„œ idì™€ password ì¼ì¹˜ í™•ì¸
  for (const key in members) {
    const member = members[key];
    if (member.id === id && member.password === password) {
      return { ...member, key }; // íšŒì› ì •ë³´ì™€ key ë°˜í™˜
    }
  }
  
  return null; // ì¼ì¹˜í•˜ëŠ” íšŒì› ì—†ìŒ
}

// âœ… íšŒì› ì‚­ì œ í•¨ìˆ˜
export async function deleteMember(key) {
  const memberRef = ref(db, `terraone/tel/${key}`);
  return remove(memberRef)
    .then(() => console.log("âœ… íšŒì› ì‚­ì œ ì™„ë£Œ"))
    .catch(err => console.error("âŒ ì‚­ì œ ì‹¤íŒ¨:", err));
}

// âœ… íšŒì› ìˆ˜ì • í•¨ìˆ˜
export async function updateMember(key, updatedData) {
  const memberRef = ref(db, `terraone/tel/${key}`);
  return update(memberRef, updatedData)
    .then(() => console.log("âœ… íšŒì› ìˆ˜ì • ì™„ë£Œ"))
    .catch(err => console.error("âŒ ìˆ˜ì • ì‹¤íŒ¨:", err));
}



=====================================================================


// ğŸ“ public/js/firebase-config.js
// Firebase ê¸°ë³¸ ì„¤ì • íŒŒì¼

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";
import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-analytics.js";
import { getDatabase, connectDatabaseEmulator } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-database.js";

// Firebase í”„ë¡œì íŠ¸ ì„¤ì • ì •ë³´
const firebaseConfig = {
  apiKey: "AIzaSyAF7AD1d54k21-stmb0Hpg9OMEECvzFHpQ",
  authDomain: "terraone-d0318.firebaseapp.com",
  databaseURL: "https://terraone-d0318-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "terraone-d0318",
  storageBucket: "terraone-d0318.firebasestorage.app",
  messagingSenderId: "1082807340877",
  appId: "1:1082807340877:web:6e2b49c04562d800e87104",
  measurementId: "G-7HMJEV832S"
};

// Firebase ì•± ì´ˆê¸°í™”
const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);
const db = getDatabase(app);

// ğŸ”¥ ë¡œì»¬ í™˜ê²½ì—ì„œë§Œ ì—ë®¬ë ˆì´í„° ì—°ê²°
if (location.hostname === "localhost" || location.hostname === "127.0.0.1") {
  console.log("ğŸ”§ ë¡œì»¬ í™˜ê²½ ê°ì§€ - Firebase Emulatorì— ì—°ê²°í•©ë‹ˆë‹¤.");
  connectDatabaseEmulator(db, "localhost", 9000);
} else {
  console.log("ğŸŒ í”„ë¡œë•ì…˜ í™˜ê²½ - ì‹¤ì œ Firebaseì— ì—°ê²°í•©ë‹ˆë‹¤.");
}

// ë‹¤ë¥¸ íŒŒì¼ì—ì„œ Firebase ì•±ì„ ì“¸ ìˆ˜ ìˆë„ë¡ export
export { app, db };


=====================================================================

// ğŸ“ public/js/auth.js
// íšŒì›ê°€ì…
// signup.js

import { addMember } from "./firebase-db.js"; // DB í•¨ìˆ˜ import

const form = document.getElementById("signupForm");
const messageDiv = document.getElementById("message");

form.addEventListener("submit", async (e) => {
  e.preventDefault();

  const member = {
    id: document.getElementById("id").value.trim(),
    password: document.getElementById("password").value.trim(),
    name: document.getElementById("name").value.trim(),
    tel: document.getElementById("tel").value.trim(),
    addr: document.getElementById("addr").value.trim(),
    remark: document.getElementById("remark").value.trim(),
    sms: document.getElementById("sms").value.trim(),
    sms_2: document.getElementById("sms_2").value
      ? document.getElementById("sms_2").value.split(",").map(s => s.trim())
      : [],
    level: parseInt(document.getElementById("level").value, 10)
  };

  try {
    await addMember(member); // DBì— ì¶”ê°€
    messageDiv.textContent = "âœ… íšŒì›ê°€ì… ì™„ë£Œ!";
    form.reset();
  } catch (err) {
    console.error(err);
    messageDiv.textContent = "âŒ íšŒì›ê°€ì… ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";
  }
});


=====================================================================

// ğŸ“ public/js/auth.js
// ë¡œê·¸ì¸ ì¸ì¦

// âœ… ë¡œê·¸ì¸ ì—¬ë¶€ í™•ì¸
export function isLoggedIn() {
  const user = sessionStorage.getItem("loggedInUser");
  return user !== null;
}

// âœ… í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ì •ë³´ ê°€ì ¸ì˜¤ê¸°
export function getCurrentUser() {
  const user = sessionStorage.getItem("loggedInUser");
  return user ? JSON.parse(user) : null;
}

// âœ… ê´€ë¦¬ì ê¶Œí•œ í™•ì¸ (level 10)
export function isAdmin() {
  const user = getCurrentUser();
  return user && user.level === 10;
}

// âœ… ë¡œê·¸ì•„ì›ƒ
export function logout() {
  sessionStorage.removeItem("loggedInUser");
  window.location.href = "login.html";
}

// âœ… ê´€ë¦¬ì í˜ì´ì§€ ì ‘ê·¼ ì²´í¬ (ê´€ë¦¬ìê°€ ì•„ë‹ˆë©´ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™)
export function requireAdmin() {
  if (!isLoggedIn()) {
    alert("âŒ ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
    window.location.href = "login.html";
    return false;
  }
  
  if (!isAdmin()) {
    alert("âŒ ê´€ë¦¬ìë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
    window.location.href = "login.html";
    return false;
  }
  
  return true;
}

// âœ… ë¡œê·¸ì¸ í˜ì´ì§€ ì ‘ê·¼ ì²´í¬ (ì´ë¯¸ ë¡œê·¸ì¸í–ˆìœ¼ë©´ members.htmlë¡œ ì´ë™)
export function requireGuest() {
  if (isLoggedIn() && isAdmin()) {
    window.location.href = "members.html";
    return false;
  }
  return true;
}

=====================================================================

// ğŸ“ public/js/members.js
// íšŒì› ëª©ë¡
// members.js
import { getAllMembers, deleteMember } from "./firebase-db.js";
import { requireAdmin, getCurrentUser, logout } from "./auth.js";

// ğŸ”¥ ê´€ë¦¬ì ê¶Œí•œ ì²´í¬ (í˜ì´ì§€ ì§„ì… ì‹œ)
if (!requireAdmin()) {
  // requireAdmin()ì—ì„œ ì´ë¯¸ ë¦¬ë‹¤ì´ë ‰íŠ¸ ì²˜ë¦¬ë¨
}

const tbody = document.querySelector("#membersTable tbody");
const selectAllCheckbox = document.querySelector("#selectAll");
const viewBtn = document.querySelector("#viewSelected");
const editBtn = document.querySelector("#editSelected");
const deleteBtn = document.querySelector("#deleteSelected");
const messageDiv = document.querySelector("#message");

// ğŸ”¹ ìš”ì†Œ ì¡´ì¬ í™•ì¸
if (!tbody) {
  console.error("âŒ tbody ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!");
  alert("í˜ì´ì§€ êµ¬ì¡°ì— ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤. HTMLì„ í™•ì¸í•˜ì„¸ìš”.");
}

// ğŸ”¹ íšŒì› ëª©ë¡ ë Œë”ë§
async function renderMembers() {
  console.log("ğŸ” renderMembers í•¨ìˆ˜ ì‹œì‘");
  
  if (!tbody) {
    console.error("âŒ tbodyê°€ nullì…ë‹ˆë‹¤!");
    return;
  }
  
  tbody.innerHTML = "<tr><td colspan='10' class='text-center'>ë°ì´í„° ë¡œë”© ì¤‘...</td></tr>";
  
  try {
    const membersData = await getAllMembers();
    console.log("ğŸ“¦ ë¶ˆëŸ¬ì˜¨ ë°ì´í„°:", membersData);
    console.log("ğŸ“Š ë°ì´í„° ê°œìˆ˜:", Object.keys(membersData).length);

    if (!membersData || Object.keys(membersData).length === 0) {
      tbody.innerHTML = `<tr><td colspan="10" class="text-center">ë“±ë¡ëœ íšŒì›ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>`;
      return;
    }

    // ë ˆë²¨ ìˆ«ìë¥¼ ë¬¸ìì—´ë¡œ ë§¤í•‘
    const levelText = { 1: "íšŒì›", 2: "íšŒì›+", 10: "ê´€ë¦¬ì" };

    tbody.innerHTML = ""; // ê¸°ì¡´ ë‚´ìš© ì§€ìš°ê¸°
    let idx = 1;
    
    for (const key in membersData) {
      const m = membersData[key];
      console.log(`ğŸ‘¤ íšŒì› ${idx}:`, key, m);
      
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td><input type="checkbox" class="selectMember" data-key="${key}"></td>
        <td>${idx}</td>
        <td>${m.id || ""}</td>
        <td>${m.name || ""}</td>
        <td>${m.tel || ""}</td>
        <td>${m.addr || ""}</td>
        <td>${m.remark || ""}</td>
        <td>${m.sms || ""}</td>
        <td>${Array.isArray(m.sms_2) ? m.sms_2.join(", ") : m.sms_2 || ""}</td>
        <td>${levelText[m.level] || "íšŒì›"}</td>
      `;
      tbody.appendChild(tr);
      idx++;
    }
    
    console.log("âœ… ë Œë”ë§ ì™„ë£Œ!");
  } catch (error) {
    console.error("âŒ ì—ëŸ¬ ë°œìƒ:", error);
    tbody.innerHTML = `<tr><td colspan="10" class="text-center text-danger">ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨: ${error.message}</td></tr>`;
  }
}

// ğŸ”¹ ì „ì²´ ì„ íƒ ì²´í¬ë°•ìŠ¤
if (selectAllCheckbox) {
  selectAllCheckbox.addEventListener("change", () => {
    const checkboxes = document.querySelectorAll(".selectMember");
    checkboxes.forEach(cb => cb.checked = selectAllCheckbox.checked);
  });
}

// ğŸ”¹ ì„ íƒ íšŒì› ìˆ˜ì •
if (editBtn) {
  editBtn.addEventListener("click", () => {
    const selectedKeys = Array.from(document.querySelectorAll(".selectMember:checked"))
      .map(cb => cb.dataset.key);

    if (selectedKeys.length === 0) {
      alert("ìˆ˜ì •í•  íšŒì›ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");
      return;
    }
    if (selectedKeys.length > 1) {
      alert("í•œ ë²ˆì— í•œ ëª…ë§Œ ìˆ˜ì • ê°€ëŠ¥í•©ë‹ˆë‹¤.");
      return;
    }

    const key = selectedKeys[0];
    window.location.href = `edit-member.html?key=${key}`;
  });
}

// ğŸ”¹ ì„ íƒ íšŒì› ì‚­ì œ
if (deleteBtn) {
  deleteBtn.addEventListener("click", async () => {
    const selectedKeys = Array.from(document.querySelectorAll(".selectMember:checked"))
      .map(cb => cb.dataset.key);

    if (selectedKeys.length === 0) {
      alert("ì‚­ì œí•  íšŒì›ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");
      return;
    }

    if (!confirm("ì„ íƒí•œ íšŒì›ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;

    for (const key of selectedKeys) {
      await deleteMember(key);
    }

    if (messageDiv) {
      messageDiv.textContent = "âœ… ì„ íƒ íšŒì› ì‚­ì œ ì™„ë£Œ!";
    }
    renderMembers();
  });
}

// ğŸ”¹ í˜ì´ì§€ ë¡œë“œ ì‹œ íšŒì› ëª©ë¡ í‘œì‹œ
console.log("ğŸ“„ í˜ì´ì§€ ë¡œë“œë¨");
window.addEventListener("DOMContentLoaded", () => {
  console.log("ğŸš€ DOMContentLoaded ì´ë²¤íŠ¸ ë°œìƒ");
  
  // ğŸ”¥ ë¡œê·¸ì¸ ì‚¬ìš©ì ì •ë³´ í‘œì‹œ
  const user = getCurrentUser();
  if (user) {
    console.log(`ğŸ‘‹ ${user.name}ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤! (Level: ${user.level})`);
  }
  
  renderMembers();
});


// ë©¤ë²„ì „ì²´ëª©ë¡ í˜ì´ì§€(members.html) íšŒì›ì—´ëŒ í´ë¦­ì‹œ ì´ë™
viewBtn.addEventListener("click", () => {
  window.location.href = "index.html";
});





=====================================================================

// ğŸ“ public/js/edit-member.js
// íšŒì›í¸ì§‘(ìˆ˜ì •/ì‚­ì œ)

// edit-member.js
import { getDatabase, ref, get, update } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-database.js";
import { app } from "./firebase-config.js";
import { requireAdmin } from "./auth.js";

// ğŸ”¥ ê´€ë¦¬ì ê¶Œí•œ ì²´í¬
if (!requireAdmin()) {
  // requireAdmin()ì—ì„œ ì´ë¯¸ ë¦¬ë‹¤ì´ë ‰íŠ¸ ì²˜ë¦¬ë¨
}

const db = getDatabase(app);

// URLì—ì„œ key ê°€ì ¸ì˜¤ê¸°
const urlParams = new URLSearchParams(window.location.search);
const memberKey = urlParams.get("key");

// í¼ ìš”ì†Œ
const nameInput = document.getElementById("name");
const telInput = document.getElementById("tel");
const addrInput = document.getElementById("addr");
const remarkInput = document.getElementById("remark");
const smsInput = document.getElementById("sms");
const sms2Input = document.getElementById("sms2");
const levelSelect = document.getElementById("level");
const form = document.getElementById("editForm");
const messageDiv = document.getElementById("message");

// ğŸ”¹ ê¸°ì¡´ íšŒì› ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
async function loadMember() {
  const memberRef = ref(db, `terraone/tel/${memberKey}`);
  const snapshot = await get(memberRef);
  if (snapshot.exists()) {
    const m = snapshot.val();
    nameInput.value = m.name || "";
    telInput.value = m.tel || "";
    addrInput.value = m.addr || "";
    remarkInput.value = m.remark || "";
    smsInput.value = m.sms || "";
    sms2Input.value = m.sms_2 || "";
    levelSelect.value = m.level || "1";
  } else {
    messageDiv.textContent = "âš ï¸ íšŒì› ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
  }
}

// ğŸ”¹ í¼ ì œì¶œ ì‹œ ì—…ë°ì´íŠ¸
form.addEventListener("submit", async (e) => {
  e.preventDefault();
  const updatedData = {
    name: nameInput.value,
    tel: telInput.value,
    addr: addrInput.value,
    remark: remarkInput.value,
    sms: smsInput.value,
    sms_2: sms2Input.value,
    level: parseInt(levelSelect.value)
  };

  const memberRef = ref(db, `terraone/tel/${memberKey}`);
  try {
    await update(memberRef, updatedData);
    messageDiv.textContent = "âœ… íšŒì› ìˆ˜ì • ì™„ë£Œ!";
    setTimeout(() => {
      window.location.href = "members.html";
    }, 1500);
  } catch (err) {
    console.error(err);
    messageDiv.textContent = "âŒ ìˆ˜ì • ì‹¤íŒ¨!";
  }
});

loadMember();




=====================================================================

// ğŸ“ public/js/index-firebase.js
// íšŒì› ì „í™”ì—°ë½ë§ View


// ğŸ“ public/js/index-firebase.js
// index.htmlì—ì„œ Firebase ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™€ members.htmlê³¼ ë™ì¼í•œ í˜•ì‹ìœ¼ë¡œ í…Œì´ë¸” ìƒì„±
// ë²ˆí˜¸, ì´ë¦„, ì „í™”ë²ˆí˜¸, ì£¼ì†Œ, ë¹„ê³ , SMS ë°ì´í„°ë§Œ í‘œì‹œ

import { getAllMembers } from "./firebase-db.js";

const tbody = document.getElementById("memberTableBody");

// ğŸ”¹ SMS ì „ì†¡ í•¨ìˆ˜ (ê¸°ì¡´ ë°©ì‹ ìœ ì§€)
window.sendSMS = function (event, phoneNumbers) {
  event.preventDefault();

  // iOSì™€ Androidì—ì„œ ëª¨ë‘ ì‘ë™í•˜ë„ë¡ ì²˜ë¦¬
  const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);
  const smsUrl = isIOS
    ? `sms:${phoneNumbers}&body=`
    : `sms:${phoneNumbers}?body=`;

  window.location.href = smsUrl;
};

// ğŸ”¹ íšŒì› ëª©ë¡ ë Œë”ë§
async function renderMembers() {
  console.log("ğŸ” Firebaseì—ì„œ íšŒì› ë°ì´í„° ë¡œë”© ì‹œì‘...");

  try {
    const membersData = await getAllMembers();
    console.log("ğŸ“¦ ë¶ˆëŸ¬ì˜¨ ë°ì´í„°:", membersData);

    if (!membersData || Object.keys(membersData).length === 0) {
      tbody.innerHTML = `
        <tr>
          <td colspan="6" class="text-center">ë“±ë¡ëœ íšŒì›ì´ ì—†ìŠµë‹ˆë‹¤.</td>
        </tr>
      `;
      return;
    }

    // ğŸ”¥ íšŒì› ë°ì´í„°ë¥¼ ë°°ì—´ë¡œ ë³€í™˜
    const membersArray = Object.entries(membersData).map(([key, member]) => ({
      key,
      ...member,
    }));

    // ì´ë¦„ìˆœ ì •ë ¬
    membersArray.sort((a, b) => {
      if (a.name < b.name) return -1;
      if (a.name > b.name) return 1;
      return 0;
    });

    // ğŸ”¥ ì „ì²´ ì „í™”ë²ˆí˜¸ ëª©ë¡ ìƒì„± (íšŒì¥/ì´ë¬´ SMS ë°œì†¡ìš©)
    const allPhoneNumbers = membersArray
      .filter((m) => m.tel)
      .map((m) => m.tel)
      .join(",");

    tbody.innerHTML = ""; // ê¸°ì¡´ ë‚´ìš© ì§€ìš°ê¸°

    // ğŸ”¥ íšŒì› ëª©ë¡ ìƒì„± (members.htmlê³¼ ë™ì¼í•œ í˜•ì‹)
    membersArray.forEach((member, index) => {
      const tr = document.createElement("tr");

      // ğŸ”¥ íšŒì¥ì´ë‚˜ ì´ë¬´ì¸ ê²½ìš° íŠ¹ë³„ ì²˜ë¦¬
      const isPresident = member.remark === "íšŒì¥";
      const isTreasurer = member.remark === "ì´ë¬´";

      // ê¸°ì¡´ index.htmlì˜ í´ë˜ìŠ¤ëª… ê·¸ëŒ€ë¡œ ì‚¬ìš©
      tr.innerHTML = `
        <td class="no_1">${index + 1}</td>
        <td class="name_1">
          <a href="tel:${member.tel || ""}"><span>${member.name || ""}</span></a>
        </td>
        <td class="tel_1">
          <a href="tel:${member.tel || ""}"><span>${member.tel || ""}</span></a>
        </td>

        <td class="address_1">
          <span>${member.addr || ""}</span>
        </td>

        <!-- (ì•„ë˜ì½”ë“œ) <span>${member.remark || "&nbsp;"}</span> ëŠ”
             ì „í™” ì—°ë½ë§í˜ì´ì§€ì— ë‚˜íƒ€ë‚˜ëŠ” ê±°ì£¼ì§€ì˜ íšŒì¥/ì´ë¬´ ê¸€ìë¶€ë¶„ì—
             ì „í™”ë²ˆí˜¸ë¥¼ ë§í¬ì§€ì • ë˜ì–´ìˆë‹¤. -->
        <td class="remark_1">
          ${
            isPresident || isTreasurer
              ? `<a href="sms:${allPhoneNumbers}" onclick="sendSMS(event,'${allPhoneNumbers}')">
                   <span>${member.remark || "&nbsp;"}</span>
                 </a>`
              : `<span>${member.remark || "&nbsp;"}</span>`
          }
        </td>

        <td class="sms_1">
          <a href="sms:${member.tel || ""}" onclick="sendSMS(event,'${member.tel || ""}')">
            <span><img class="max-small" src="image/sms-4.png" /></span>
          </a>
        </td>
      `;

      tbody.appendChild(tr);
    });

    console.log("âœ… íšŒì› ëª©ë¡ ë Œë”ë§ ì™„ë£Œ! ì´ " + membersArray.length + "ëª…");
  } catch (error) {
    console.error("âŒ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:", error);
    tbody.innerHTML = `
      <tr>
        <td colspan="6" class="text-center" style="color: red;">
          ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨: ${error.message}
        </td>
      </tr>
    `;
  }
}

// ğŸ”¹ í˜ì´ì§€ ë¡œë“œ ì‹œ íšŒì› ëª©ë¡ í‘œì‹œ
console.log("ğŸ“„ index.html í˜ì´ì§€ ë¡œë“œë¨");
window.addEventListener("DOMContentLoaded", () => {
  console.log("ğŸš€ DOMContentLoaded ì´ë²¤íŠ¸ ë°œìƒ");
  renderMembers();
});

// ğŸ”¥ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ ì˜µì…˜ (ì„ íƒì‚¬í•­)
// members.htmlì—ì„œ ìˆ˜ì •/ì‚­ì œ ì‹œ ìë™ìœ¼ë¡œ index.html ì—…ë°ì´íŠ¸
// ì•„ë˜ ì£¼ì„ì„ í•´ì œí•˜ë©´ ì‹¤ì‹œê°„ ë™ê¸°í™” í™œì„±í™”ë©ë‹ˆë‹¤.
/*
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-database.js";
import { app } from "./firebase-config.js";

const db = getDatabase(app);
const membersRef = ref(db, "terraone/tel");

onValue(membersRef, (snapshot) => {
  console.log("ğŸ”¥ Firebase ë°ì´í„° ë³€ê²½ ê°ì§€! ìë™ ìƒˆë¡œê³ ì¹¨...");
  renderMembers();
});
*/


=====================================================================









