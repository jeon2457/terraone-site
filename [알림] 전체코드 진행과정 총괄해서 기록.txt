

ğŸ”„ ì‹œìŠ¤í…œ ì „ì²´ íë¦„ë„
ğŸ“Š 1. ì´ˆê¸° ì ‘ê·¼ ë° ê¶Œí•œ ë¶„ê¸°
ì‚¬ìš©ì ì ‘ê·¼
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  í˜ì´ì§€ ìœ í˜•?   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“           â†“
  ê³µê°œ       ê´€ë¦¬ì ì „ìš©

ğŸŒ ê³µê°œ í˜ì´ì§€ íë¦„ (ê²€ì¦ ì—†ìŒ)
A. íšŒì›ì—°ë½ë§ ë©”ì¸ (index.html)
1. í˜ì´ì§€ ë¡œë“œ
2. index-firebase.js ì‹¤í–‰
   â”œâ”€ getAllMembers() í˜¸ì¶œ
   â”œâ”€ Firebase Realtime Database ì—°ê²°
   â”‚  â””â”€ terraone/tel ê²½ë¡œ ì¡°íšŒ
   â”œâ”€ 20ëª… íšŒì› ë°ì´í„° ìˆ˜ì‹ 
   â”œâ”€ ì´ë¦„ìˆœ ì •ë ¬
   â””â”€ í…Œì´ë¸” ë Œë”ë§
3. ê²°ê³¼ í‘œì‹œ:
   - ë²ˆí˜¸, ì´ë¦„, ì „í™”ë²ˆí˜¸, ì£¼ì†Œ, ë¹„ê³ , SMS
   - ì „í™” í´ë¦­ â†’ tel: ë§í¬
   - SMS í´ë¦­ â†’ sms: ë§í¬
B. ì‚¬ìš©ë‚´ì—­ì„œ ë³´ê¸° (account_view.html)
1. í˜ì´ì§€ ë¡œë“œ
2. Firebase ì´ˆê¸°í™”
3. ì›” ë²„íŠ¼ ë Œë”ë§ (1ì›”~12ì›”)
4. í˜„ì¬ ì›” ìë™ ì„ íƒ
5. ë°ì´í„° ë¡œë“œ:
   â”œâ”€ income_table (ìˆ˜ì…)
   â””â”€ expense_table (ì§€ì¶œ)
6. ì›”ë³„ í•„í„°ë§ ë° í‘œì‹œ
7. í•©ê³„ ê³„ì‚°:
   â”œâ”€ ì›” ìˆ˜ì…/ì§€ì¶œ í•©ê³„
   â”œâ”€ ì—° ìˆ˜ì…/ì§€ì¶œ í•©ê³„
   â””â”€ ì´ ì”ì•¡ (ìˆ˜ì… - ì§€ì¶œ)
C. ì˜ìˆ˜ì¦ ë³´ê¸° (images_view.html)
1. í˜ì´ì§€ ë¡œë“œ
2. Firebase Storage ì—°ê²°
3. ì›” ë²„íŠ¼ ë Œë”ë§
4. í˜„ì¬ ì›”(11ì›”) ìë™ ì„ íƒ
5. images_table ë°ì´í„° ë¡œë“œ
6. ì´ë¯¸ì§€ ì¸ë„¤ì¼ í‘œì‹œ
7. ì‚¬ìš©ì ì•¡ì…˜:
   â”œâ”€ ì¸ë„¤ì¼ í´ë¦­ â†’ í™•ëŒ€ ëª¨ë‹¬
   â””â”€ ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ â†’ íŒŒì¼ ì €ì¥

ğŸ”’ ê´€ë¦¬ì í˜ì´ì§€ íë¦„ (ê²€ì¦ í•„ìš”)
1ë‹¨ê³„: ì ‘ê·¼ ì‹œë„
ì‚¬ìš©ìê°€ ê´€ë¦¬ì í˜ì´ì§€ ì ‘ê·¼
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ account_input.html   â”‚
â”‚ account_edit.html    â”‚
â”‚ images_input.html    â”‚
â”‚ images_edit.html     â”‚
â”‚ members.html         â”‚
â”‚ edit-member.html     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
requireAdmin() ì‹¤í–‰
2ë‹¨ê³„: ê¶Œí•œ ê²€ì¦ (auth.js)
javascriptrequireAdmin() ì‹¤í–‰
    â†“
1. sessionStorage í™•ì¸
   â””â”€ loggedInUser ìˆëŠ”ê°€?
       â”œâ”€ ì—†ìŒ â”€â”€â†’ "ë¡œê·¸ì¸ í•„ìš”" ì•Œë¦¼
       â”‚          â””â”€ í˜„ì¬ URL ì €ì¥
       â”‚          â””â”€ login.html ì´ë™
       â””â”€ ìˆìŒ â”€â”€â†’ 2ë‹¨ê³„
    â†“
2. ê´€ë¦¬ì ê¶Œí•œ í™•ì¸
   â””â”€ user.level === 10?
       â”œâ”€ ì•„ë‹˜ â”€â”€â†’ "ê´€ë¦¬ìë§Œ ì ‘ê·¼ ê°€ëŠ¥" ì•Œë¦¼
       â”‚          â””â”€ í˜„ì¬ URL ì €ì¥
       â”‚          â””â”€ login.html ì´ë™
       â””â”€ ë§ìŒ â”€â”€â†’ âœ… í˜ì´ì§€ ì§„ì… í—ˆìš©
```

### **3ë‹¨ê³„: ë¡œê·¸ì¸ í”„ë¡œì„¸ìŠ¤ (login.html)**
```
1. ì‚¬ìš©ì ID/PW ì…ë ¥
    â†“
2. login.js ì‹¤í–‰
   â”œâ”€ firebase-db.jsì˜ login() í˜¸ì¶œ
   â”œâ”€ Databaseì—ì„œ íšŒì› ì •ë³´ ì¡°íšŒ
   â”‚  â””â”€ terraone/tel ì „ì²´ ìŠ¤ìº”
   â””â”€ ID/PW ë§¤ì¹­ í™•ì¸
    â†“
3. ë¡œê·¸ì¸ ì„±ê³µ?
   â”œâ”€ ì‹¤íŒ¨ â†’ "ì˜ëª»ëœ ì •ë³´" ë©”ì‹œì§€
   â””â”€ ì„±ê³µ â†’ 4ë‹¨ê³„
    â†“
4. ê¶Œí•œ í™•ì¸ (level)
   â”œâ”€ level !== 10 â†’ "ê´€ë¦¬ìë§Œ ì ‘ê·¼" ì•Œë¦¼
   â”‚                â””â”€ ì„¸ì…˜ ì‚­ì œ
   â””â”€ level === 10 â†’ 5ë‹¨ê³„
    â†“
5. ì„¸ì…˜ ì €ì¥
   â”œâ”€ sessionStorage.setItem("loggedInUser", {
   â”‚    key, id, name, level: 10
   â”‚  })
   â””â”€ ë¦¬ë‹¤ì´ë ‰íŠ¸ ê²°ì •
       â”œâ”€ redirectAfterLogin ìˆìŒ?
       â”‚  â””â”€ ì €ì¥ëœ URLë¡œ ì´ë™ (ì›ë˜ ê°€ë ¤ë˜ í˜ì´ì§€)
       â””â”€ redirectAfterLogin ì—†ìŒ?
          â””â”€ members.htmlë¡œ ì´ë™ (ê¸°ë³¸)
```

---

## ğŸ“ **ê´€ë¦¬ì ê¸°ëŠ¥ ìƒì„¸ íë¦„**

### **D. ì‚¬ìš©ë‚´ì—­ì„œ ì…ë ¥ (account_input.html)**
```
âœ… requireAdmin() í†µê³¼
    â†“
1. í˜ì´ì§€ ë Œë”ë§
   â”œâ”€ ìˆ˜ì…/ì§€ì¶œ ë²„íŠ¼ (ì´ˆë¡/ë¹¨ê°•)
   â”œâ”€ ë‚ ì§œ (ì˜¤ëŠ˜ ìë™ ì„¤ì •)
   â”œâ”€ í•­ëª©, ë¹„ê³ , ê¸ˆì•¡ ì…ë ¥í¼
   â””â”€ ë“±ë¡í•˜ê¸° ë²„íŠ¼
    â†“
2. ì‚¬ìš©ì ì…ë ¥ ëŒ€ê¸°
    â†“
3. ë“±ë¡í•˜ê¸° í´ë¦­
   â”œâ”€ í˜„ì¬ íƒ€ì… í™•ì¸ (income/expense)
   â”œâ”€ ì…ë ¥ ë°ì´í„° ê²€ì¦
   â””â”€ Firebase ì €ì¥:
       â”œâ”€ income_table ë˜ëŠ”
       â””â”€ expense_table
           â””â”€ push({
                 date, category, description, 
                 amount, timestamp
               })
    â†“
4. ê²°ê³¼ ì²˜ë¦¬
   â”œâ”€ ì„±ê³µ â†’ "âœ… ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤"
   â”‚        â””â”€ í¼ ì´ˆê¸°í™”
   â””â”€ ì‹¤íŒ¨ â†’ "âŒ ì˜¤ë¥˜ ë°œìƒ" ì•Œë¦¼
```

### **E. ì˜ìˆ˜ì¦ ì…ë ¥ (images_input.html)**
```
âœ… requireAdmin() í†µê³¼
    â†“
1. í˜ì´ì§€ ë Œë”ë§
   â”œâ”€ ë‚ ì§œ ì„ íƒ
   â”œâ”€ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì˜ì—­ (ë“œë˜ê·¸&ë“œë¡­)
   â”œâ”€ ìš”ì•½ ì…ë ¥
   â””â”€ ì—…ë¡œë“œ ë²„íŠ¼
    â†“
2. ì´ë¯¸ì§€ ì„ íƒ
   â”œâ”€ í´ë¦­ ë˜ëŠ” ë“œë˜ê·¸&ë“œë¡­
   â”œâ”€ íŒŒì¼ ê²€ì¦
   â”‚  â”œâ”€ íƒ€ì… ì²´í¬ (image/*)
   â”‚  â””â”€ í¬ê¸° ì²´í¬ (5MB ì´í•˜)
   â””â”€ ë¯¸ë¦¬ë³´ê¸° í‘œì‹œ
    â†“
3. ì—…ë¡œë“œí•˜ê¸° í´ë¦­
   â”œâ”€ ë²„íŠ¼ ë¹„í™œì„±í™”
   â”œâ”€ ì§„í–‰ë¥  í‘œì‹œ ì‹œì‘
   â””â”€ Firebase Storage ì—…ë¡œë“œ:
       â””â”€ images/YYYY-MM-DD_timestamp_filename.jpg
    â†“
4. ì—…ë¡œë“œ ì§„í–‰
   â”œâ”€ uploadBytesResumable() ì‚¬ìš©
   â”œâ”€ ì§„í–‰ë¥  ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ (0%â†’100%)
   â””â”€ ì™„ë£Œ ì‹œ URL íšë“
    â†“
5. Database ì €ì¥
   â”œâ”€ images_tableì— push:
   â”‚  â””â”€ { date, summary, imageUrl, 
   â”‚       fileName, timestamp }
   â””â”€ ì„±ê³µ ì²˜ë¦¬
    â†“
6. ê²°ê³¼
   â”œâ”€ ì„±ê³µ â†’ "âœ… ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤"
   â”‚        â””â”€ í¼ ì´ˆê¸°í™”
   â””â”€ ì‹¤íŒ¨ â†’ "âŒ ì—…ë¡œë“œ ì‹¤íŒ¨" ì•Œë¦¼
```

### **F. ì˜ìˆ˜ì¦ í¸ì§‘ (images_edit.html)**
```
âœ… requireAdmin() í†µê³¼
    â†“
1. ë°ì´í„° ë¡œë“œ
   â”œâ”€ images_table ì‹¤ì‹œê°„ ê°ì‹œ (onValue)
   â””â”€ ì›”ë³„ í•„í„°ë§
    â†“
2. í…Œì´ë¸” ë Œë”ë§
   â”œâ”€ ë²ˆí˜¸, ë‚ ì§œ, ì´ë¯¸ì§€, ìš”ì•½, ì‘ì—…
   â””â”€ ê° í–‰ë§ˆë‹¤:
       â”œâ”€ âœï¸ ìˆ˜ì • ë²„íŠ¼
       â””â”€ ğŸ—‘ï¸ ì‚­ì œ ë²„íŠ¼
    â†“
3-A. ìˆ˜ì • í´ë¦­ ì‹œ
   â”œâ”€ í•´ë‹¹ í–‰ í¸ì§‘ ëª¨ë“œ ì „í™˜
   â”‚  â”œâ”€ ë‚ ì§œ â†’ input[type=date]
   â”‚  â””â”€ ìš”ì•½ â†’ textarea
   â”œâ”€ ë²„íŠ¼ ë³€ê²½:
   â”‚  â”œâ”€ ğŸ’¾ ì €ì¥
   â”‚  â””â”€ âŒ ì·¨ì†Œ
   â””â”€ ì €ì¥ í´ë¦­:
       â”œâ”€ update(images_table/${id}, {
       â”‚    date, summary
       â”‚  })
       â””â”€ ì„±ê³µ â†’ ì¼ë°˜ ëª¨ë“œ ë³µê·€
    â†“
3-B. ì‚­ì œ í´ë¦­ ì‹œ
   â”œâ”€ í™•ì¸ ëŒ€í™”ìƒì
   â”œâ”€ í™•ì¸ ì‹œ:
   â”‚  â”œâ”€ Storageì—ì„œ ì´ë¯¸ì§€ ì‚­ì œ
   â”‚  â”‚  â””â”€ deleteObject(imageRef)
   â”‚  â””â”€ Databaseì—ì„œ ë°ì´í„° ì‚­ì œ
   â”‚     â””â”€ remove(images_table/${id})
   â””â”€ í…Œì´ë¸” ìë™ ê°±ì‹ 
```

### **G. íšŒì› ëª©ë¡ (members.html)**
```
âœ… requireAdmin() í†µê³¼
    â†“
1. ì‚¬ìš©ì ì •ë³´ í™•ì¸
   â”œâ”€ getCurrentUser()
   â””â”€ ê´€ë¦¬ì í™˜ì˜ ë©”ì‹œì§€
    â†“
2. íšŒì› ë°ì´í„° ë¡œë“œ
   â”œâ”€ getAllMembers()
   â””â”€ terraone/tel ì¡°íšŒ
    â†“
3. í…Œì´ë¸” ë Œë”ë§
   â”œâ”€ ì²´í¬ë°•ìŠ¤, ë²ˆí˜¸, ID, ì´ë¦„, ì „í™”
   â”œâ”€ ì£¼ì†Œ, ë¹„ê³ , SMS, SMS_2, ë ˆë²¨
   â””â”€ ë ˆë²¨ í‘œì‹œ:
       â”œâ”€ 1 â†’ "ì„ì‹œíšŒì›"
       â”œâ”€ 2 â†’ "íšŒì›+"
       â””â”€ 10 â†’ "ê´€ë¦¬ì"
    â†“
4. ì•¡ì…˜ ë²„íŠ¼
   â”œâ”€ íšŒì›ê°€ì… â†’ signup.html
   â”œâ”€ íšŒì›ì—´ëŒ â†’ index.html
   â”œâ”€ âœï¸ ìˆ˜ì • â†’ edit-member.html?key=xxx
   â””â”€ ğŸ—‘ï¸ ì‚­ì œ â†’ í™•ì¸ í›„ deleteMember()

ğŸ” ë³´ì•ˆ ë ˆì´ì–´
ë ˆì´ì–´ 1: Frontend ê²€ì¦
javascriptrequireAdmin() {
  if (!isLoggedIn()) â†’ login.html
  if (!isAdmin()) â†’ login.html
  return true; // í†µê³¼
}
ë ˆì´ì–´ 2: Session ê´€ë¦¬
javascript// ë¡œê·¸ì¸ ì‹œ ì €ì¥
sessionStorage.setItem("loggedInUser", {
  key, id, name, level: 10
})

// ê° í˜ì´ì§€ì—ì„œ í™•ì¸
const user = getCurrentUser();
if (user.level !== 10) â†’ ì°¨ë‹¨
ë ˆì´ì–´ 3: Firebase Rules (í˜„ì¬ ê°œë°œ ëª¨ë“œ)
jsonDatabase: { ".read": true, ".write": true }
Storage: { allow read, write: if true }
```

---

## ğŸ“Š **ë°ì´í„° êµ¬ì¡°**

### **Firebase Realtime Database**
```
terraone-d0318-default-rtdb
â”œâ”€ terraone/
â”‚  â””â”€ tel/
â”‚     â”œâ”€ {user1_key}/
â”‚     â”‚  â”œâ”€ id: "admin"
â”‚     â”‚  â”œâ”€ name: "í™ê¸¸ë™"
â”‚     â”‚  â”œâ”€ level: 10
â”‚     â”‚  â””â”€ ...
â”‚     â””â”€ {user2_key}/ ...
â”‚
â”œâ”€ income_table/
â”‚  â”œâ”€ {income1_key}/
â”‚  â”‚  â”œâ”€ date: "2024-11-15"
â”‚  â”‚  â”œâ”€ category: "ì›”ê¸‰"
â”‚  â”‚  â”œâ”€ amount: 3000000
â”‚  â”‚  â””â”€ timestamp: 1234567890
â”‚  â””â”€ ...
â”‚
â”œâ”€ expense_table/ (ë™ì¼ êµ¬ì¡°)
â”‚
â””â”€ images_table/
   â”œâ”€ {image1_key}/
   â”‚  â”œâ”€ date: "2024-11-15"
   â”‚  â”œâ”€ imageUrl: "https://..."
   â”‚  â”œâ”€ summary: "ì‹ë¹„ ì˜ìˆ˜ì¦"
   â”‚  â””â”€ timestamp: 1234567890
   â””â”€ ...
```

### **Firebase Storage**
```
terraone-d0318.appspot.com
â””â”€ images/
   â”œâ”€ 2024-11-15_1763167359330_receipt.jpg
   â”œâ”€ 2024-11-14_1763167359331_invoice.png
   â””â”€ ...

ğŸ¯ í•µì‹¬ í¬ì¸íŠ¸ ìš”ì•½

ê³µê°œ í˜ì´ì§€ (index, account_view, images_view)

ê²€ì¦ ì—†ì´ ì¦‰ì‹œ ì ‘ê·¼
Firebaseì—ì„œ ë°ì´í„° ì½ê¸°ë§Œ


ê´€ë¦¬ì í˜ì´ì§€ (account_input/edit, images_input/edit, members)

requireAdmin() í•„ìˆ˜
level 10 í™•ì¸
ì‹¤íŒ¨ ì‹œ login.html ë¦¬ë‹¤ì´ë ‰íŠ¸


ë¡œê·¸ì¸ í”„ë¡œì„¸ìŠ¤

Database ì§ì ‘ ì¡°íšŒ ë°©ì‹
sessionStorageì— ì‚¬ìš©ì ì •ë³´ ì €ì¥
ì›ë˜ í˜ì´ì§€ë¡œ ë³µê·€ ê¸°ëŠ¥


Firebase ì—°ë™

Realtime Database: íšŒì›, ìˆ˜ì…/ì§€ì¶œ, ì´ë¯¸ì§€ ë©”íƒ€ë°ì´í„°
Storage: ì‹¤ì œ ì´ë¯¸ì§€ íŒŒì¼
ë²„ì „: 10.7.1 í†µì¼


ë³´ì•ˆ

Frontend: requireAdmin()
Session: sessionStorage ê¸°ë°˜
Backend: í˜„ì¬ ê°œë°© (ê°œë°œ ëª¨ë“œ)