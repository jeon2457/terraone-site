
í•´ë‹¹ í˜ì´ì§€ë¥¼ ê²€ì¦ì ˆì°¨ë¥¼ ìœ„í•œ ì½”ë“œë¥¼ ì‚½ì…í•˜ë©´
í˜ì´ì§€ ì§„ì…ì‹œ "ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤" ë¼ëŠ” ì•ˆë‚´ì°½ì´ ëœ¬ë‹¤.


ë³´ì•ˆê²€ì¦ ì½”ë“œëŠ”,
í•´ë‹¹í˜ì´ì§€(ì˜ˆ: members_input.html , account_input.html , account_edit.html , images_input.html , images_edit.html)
<script> ì•ˆì— ì¶”ê°€ì‚½ì…í•´ì¤€ë‹¤.

=======================================================================

import { requireAdmin } from "./js/auth.js";
    // ê´€ë¦¬ì ê¶Œí•œ ì²´í¬
    if (!requireAdmin()) {
      // auth.jsì—ì„œ ìë™ìœ¼ë¡œ login.htmlë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
    }

=======================================================================

// ğŸ“ public/js/login.js

import { login } from "./firebase-db.js";

const form = document.getElementById("loginForm");
const messageDiv = document.getElementById("message");

form.addEventListener("submit", async (e) => {
  e.preventDefault();

  const id = document.getElementById("id").value;
  const password = document.getElementById("password").value;

  const member = await login(id, password);

  if (!member) {
    messageDiv.textContent = "âŒ ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.";
    return;
  }

  messageDiv.textContent = "âœ… ë¡œê·¸ì¸ ì„±ê³µ!";

  // ğŸ”¥ ì„¸ì…˜ì— ë¡œê·¸ì¸ ì •ë³´ ì €ì¥
  sessionStorage.setItem("loggedInUser", JSON.stringify({
    key: member.key,
    id: member.id,
    name: member.name,
    level: member.level
  }));

  // level ê°’ì— ë”°ë¼ í˜ì´ì§€ ì´ë™
  if (member.level === 10) {
    // ğŸ”¥ ì›ë˜ ê°€ë ¤ë˜ í˜ì´ì§€ê°€ ìˆìœ¼ë©´ ê·¸ê³³ìœ¼ë¡œ, ì—†ìœ¼ë©´ members.htmlë¡œ
    const redirectUrl = sessionStorage.getItem("redirectAfterLogin");
    
    if (redirectUrl) {
      sessionStorage.removeItem("redirectAfterLogin"); // ì‚¬ìš© í›„ ì‚­ì œ
      window.location.href = redirectUrl;
    } else {
      // ì§ì ‘ login.htmlì— ì ‘ê·¼í•œ ê²½ìš°
      window.location.href = "members.html";
    }
  } else {
    // ì¼ë°˜ íšŒì›ì€ ì ‘ê·¼ ë¶ˆê°€
    alert("âŒ ê´€ë¦¬ìë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
    sessionStorage.removeItem("loggedInUser"); // ì„¸ì…˜ ì‚­ì œ
  }
});


=======================================================================

[í•™ìŠµ]

## ğŸ¯ ì‘ë™ ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: account_input.html ì ‘ê·¼
```
1. account_input.html ì ‘ê·¼ (ë¹„ë¡œê·¸ì¸)
2. requireAdmin() ì‹¤í–‰
3. sessionStorageì— "account_input.html" ì €ì¥
4. login.htmlë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
5. ë¡œê·¸ì¸ ì„±ê³µ
6. ì €ì¥ëœ "account_input.html"ë¡œ ì´ë™ âœ…
```

### ì‹œë‚˜ë¦¬ì˜¤ 2: ì§ì ‘ login.html ì ‘ê·¼
```
1. login.html ì§ì ‘ ì ‘ê·¼
2. redirectAfterLogin ì—†ìŒ
3. ë¡œê·¸ì¸ ì„±ê³µ
4. members.htmlë¡œ ì´ë™ (ê¸°ë³¸ê°’) âœ…
```

### ì‹œë‚˜ë¦¬ì˜¤ 3: images_edit.html ì ‘ê·¼
```
1. images_edit.html ì ‘ê·¼ (ë¹„ë¡œê·¸ì¸)
2. requireAdmin() ì‹¤í–‰
3. sessionStorageì— "images_edit.html" ì €ì¥
4. login.htmlë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
5. ë¡œê·¸ì¸ ì„±ê³µ
6. ì €ì¥ëœ "images_edit.html"ë¡œ ì´ë™ âœ…


=======================================================================


// ğŸ“ public/js/auth.js
// ê¶Œí•œ ì²´í¬ ê³µí†µ ëª¨ë“ˆ

// âœ… ë¡œê·¸ì¸ ì—¬ë¶€ í™•ì¸
export function isLoggedIn() {
  const user = sessionStorage.getItem("loggedInUser");
  return user !== null;
}

// âœ… í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ì •ë³´ ê°€ì ¸ì˜¤ê¸°
export function getCurrentUser() {
  const user = sessionStorage.getItem("loggedInUser");
  return user ? JSON.parse(user) : null;
}

// âœ… ê´€ë¦¬ì ê¶Œí•œ í™•ì¸ (level 10)
export function isAdmin() {
  const user = getCurrentUser();
  return user && user.level === 10;
}

// âœ… ë¡œê·¸ì•„ì›ƒ
export function logout() {
  sessionStorage.removeItem("loggedInUser");
  window.location.href = "login.html";
}

// âœ… ê´€ë¦¬ì í˜ì´ì§€ ì ‘ê·¼ ì²´í¬ (ê´€ë¦¬ìê°€ ì•„ë‹ˆë©´ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™)
export function requireAdmin() {
  if (!isLoggedIn()) {
    // ğŸ”¥ í˜„ì¬ í˜ì´ì§€ URL ì €ì¥ (ë¡œê·¸ì¸ í›„ ëŒì•„ì˜¤ê¸° ìœ„í•´)
    sessionStorage.setItem("redirectAfterLogin", window.location.pathname + window.location.search);
    
    alert("âŒ ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
    window.location.href = "login.html";
    return false;
  }
  
  if (!isAdmin()) {
    // ğŸ”¥ í˜„ì¬ í˜ì´ì§€ URL ì €ì¥
    sessionStorage.setItem("redirectAfterLogin", window.location.pathname + window.location.search);
    
    alert("âŒ ê´€ë¦¬ìë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
    window.location.href = "login.html";
    return false;
  }
  
  return true;
}

// âœ… ë¡œê·¸ì¸ í˜ì´ì§€ ì ‘ê·¼ ì²´í¬ (ì´ë¯¸ ë¡œê·¸ì¸í–ˆìœ¼ë©´ members.htmlë¡œ ì´ë™)
export function requireGuest() {
  if (isLoggedIn() && isAdmin()) {
    window.location.href = "members.html";
    return false;
  }
  return true;
}

=======================================================================







